<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Vision of Sebastian</title>
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    .ghost-container {
      max-width: 1000px;
      margin: 0 auto;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      border-bottom: 2px solid var(--accent-gold);
    }
    .tab-button {
      padding: 10px 20px;
      background-color: transparent;
      color: var(--accent-gold);
      border: none;
      cursor: pointer;
      font-size: 1em;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
    }
    .tab-button.active {
      border-bottom-color: var(--accent-gold);
      background-color: rgba(218, 165, 32, 0.1);
    }
    .tab-button:hover {
      opacity: 0.8;
    }
    .vision-level {
      display: none;
    }
    .vision-level.active {
      display: block;
    }
    .vision-content {
      background-color: rgba(218, 165, 32, 0.05);
      border-left: 4px solid var(--accent-gold);
      padding: 20px;
      margin: 10px 0;
      color: var(--text-light);
      line-height: 1.8;
      font-style: italic;
    }
    .level-indicator {
      color: var(--accent-gold);
      font-weight: bold;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container ghost-container">
    <a href="../index.html" class="button" style="display: inline-block; margin-bottom: 20px;">← Return to Main Menu</a>

    <div style="background-color: var(--secondary-dark); border: 2px solid var(--accent-gold); padding: 30px; margin: 30px 0;">
      <h1 style="color: var(--accent-gold); margin-top: 0;" id="ghostTitle"></h1>
      <p style="font-style: italic; color: rgba(255, 255, 255, 0.8); margin-bottom: 20px;" id="ghostSubtitle"></p>

      <div style="margin-bottom: 30px;">
        <h2 style="color: var(--accent-gold); border-bottom: 1px solid var(--accent-gold); padding-bottom: 10px;">Your Story</h2>
        <p style="color: var(--text-light); line-height: 1.8;" id="ghostBackstory"></p>
      </div>

      <div>
        <h2 style="color: var(--accent-gold); border-bottom: 1px solid var(--accent-gold); padding-bottom: 10px;">Your Visions</h2>
        <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9em; margin-bottom: 20px;">
          Select how you perceive and communicate with the living:
        </p>

        <div class="tabs">
          <button class="tab-button active" onclick="switchVisionTab(event, 'full')">Full Vision</button>
          <button class="tab-button" onclick="switchVisionTab(event, 'partial')">Partial Vision</button>
          <button class="tab-button" onclick="switchVisionTab(event, 'mechanical')">Mechanical (Helmet)</button>
        </div>

        <div id="vision-full" class="vision-level active"></div>
        <div id="vision-partial" class="vision-level"></div>
        <div id="vision-mechanical" class="vision-level"></div>
      </div>
    </div>

    <div style="text-align: center; margin: 30px 0;">
      <button class="button" onclick="selectGhost()" style="padding: 15px 40px; font-size: 1.1em;">
        Become Sebastian's Ghost
      </button>
    </div>
  </div>

  <script>
    const GHOST_KEY = 'sebastian';
    const BACKSTORY = `Sebastian Crane was a brilliant chemist, obsessed with perfecting an "Elixir of Eternal Love"—a formula he believed would bind Cordelia to him forever. Working with rare botanical ingredients and his own innovations, he administered the elixir daily to Cordelia starting on September 4, 1925, during a rare Jupiter-Venus conjunction. But something went catastrophically wrong. The elixir that was meant to strengthen her devotion instead slowly poisoned her. As Sebastian realized his terrible mistake, he drank from the formula himself to understand its effects. His final days were consumed by guilt and horror as he watched the woman he loved suffer from his own creation—and found himself unable to save her.`;

    async function loadGhost() {
      try {
        const response = await fetch('../data/visions.json');
        const data = await response.json();
        
        const ghost = data.visions.find(v => v.ghost === GHOST_KEY);
        if (!ghost) {
          console.error('Ghost not found in visions.json');
          return;
        }

        // Set title and subtitle
        document.getElementById('ghostTitle').textContent = ghost.title;
        document.getElementById('ghostSubtitle').textContent = ghost.subtitle;
        document.getElementById('ghostBackstory').textContent = BACKSTORY;

        // Render visions
        renderVisions(ghost);
      } catch (error) {
        console.error('Error loading ghost data:', error);
      }
    }

    function renderVisions(ghost) {
      ['full', 'partial', 'mechanical'].forEach(level => {
        const container = document.getElementById(`vision-${level}`);
        const visions = ghost[level] || [];
        
        let html = `<div class="level-indicator">${level.toUpperCase()} VISION</div>`;
        visions.forEach(vision => {
          html += `<div class="vision-content">${vision}</div>`;
        });
        
        container.innerHTML = html;
      });
    }

    function switchVisionTab(event, level) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.vision-level').forEach(div => div.classList.remove('active'));
      event.target.classList.add('active');
      document.getElementById(`vision-${level}`).classList.add('active');
    }

    function selectGhost() {
      localStorage.setItem('characterName', 'ghost');
      window.location.href = '/index.html';
    }

    document.addEventListener('DOMContentLoaded', loadGhost);
  </script>
</body>
</html>
